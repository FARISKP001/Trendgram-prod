name = "trendgram-chat-worker"
main = "src/index.js"
compatibility_date = "2024-11-07"

[durable_objects]
bindings = [
  { name = "CHAT_ROOMS", class_name = "ChatRoom" },
  { name = "MATCHMAKER", class_name = "Matchmaker" }
]

[[migrations]]
tag = "v1"
new_classes = ["ChatRoom"]

[[migrations]]
tag = "v2"
new_classes = ["Matchmaker"]

[vars]
# Base HTTPS endpoint that the backend will call, e.g. https://chat-worker.example.workers.dev
PUBLIC_HTTP_BASE = "http://127.0.0.1:8787"
# Base WSS endpoint exposed from the Worker. Must line up with PUBLIC_HTTP_BASE.
PUBLIC_WS_BASE = "ws://127.0.0.1:8787"

# Optional: REST API URL that the Worker uses to persist reports into MongoDB.
REPORT_API_URL = "https://your-backend.example.com/api/reports"



# Production environment overrides
[env.production]
[env.production.vars]
# Set these to your deployed Worker domain (HTTPS/WSS)
PUBLIC_HTTP_BASE = "https://your-worker.example.workers.dev"
PUBLIC_WS_BASE   = "wss://your-worker.example.workers.dev"
REPORT_API_URL   = "https://your-backend.example.com/api/reports"